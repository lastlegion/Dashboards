<!DOCTYPE html>
<meta charset="utf-8">
<title>Crossfilter</title>
<link rel="stylesheet" href="dc.css" />


<script src="crossfilter.v1.min.js"></script>
<script src="d3.v3.min.js"></script>
<script src="dc.js"></script>
<style>
  body{
    font-family: Arial, Tahoma;
    font-size: 11px;
  }

</style>

<div id="body">
  <div id="data-count">
    <span class="filter-count"></span> selected out of <span class="total-count"></span> records
  </div>
  <div id="tChart">Pie</div>
  <div id="pieChart">Pie</div>
  <div id="dataTable"></div>
</div>

<script>
function print_filter(filter){
	var f=eval(filter);
	if (typeof(f.length) != "undefined") {}else{}
	if (typeof(f.top) != "undefined") {f=f.top(Infinity);}else{}
	if (typeof(f.dimension) != "undefined") {f=f.dimension(function(d) { return "";}).top(Infinity);}else{}
	console.log(filter+"("+f.length+") = "+JSON.stringify(f).replace("[","[\n\t").replace(/}\,/g,"},\n\t").replace("]","\n]"));
} 
// (It's CSV, but GitHub Pages only gzip's JSON at the moment.)
d3.json("data.json", function(err, data){
    data.forEach(function(d,i){
        console.log(d.patient_id);
    });
    console.log(data);

    var cdata = crossfilter(data),
        bcr_patient_barcode = cdata.dimension(function(d){return d.bcr_patient_barcode;});
        vital_status = cdata.dimension(function(d){return d.vital_status;});
        anatomic_neoplasm_subdivision = cdata.dimension(function(d){return d.anatomic_neoplasm_subdivision;});

        
        
        race= cdata.dimension(function(d){return d.race;});
        races = race.group();
        //console.log(races);
        person_neoplasm_cancer_status = cdata.dimension(function(d){return d.person_neoplasm_cancer_status;});        
        tumors = person_neoplasm_cancer_status.group();
        print_filter(tumors);
        print_filter(races);
    var tumorChart = dc.pieChart("#tChart");
    tumorChart.width(200).height(200)
      .dimension(person_neoplasm_cancer_status)
      .group(tumors)
      .innerRadius(30)
      .renderLabel(true)
      .label(function(p){
        if(p.key == "[Not Available]")
          return "NA"
        return p.key;
      });
      
    var raceRingChart = dc.pieChart("#pieChart");
    raceRingChart.width(200).height(200)
      .dimension(race)  
      .group(races)
      .innerRadius(30);
    dc.renderAll();
    var charts =  [
      
    ];
    
    var datatable = dc.dataTable("#dataTable");
    //datatable.dimensions(
    
    /*
    var charts = [
        barChart()
        .dimension(
    */
});
</script>
